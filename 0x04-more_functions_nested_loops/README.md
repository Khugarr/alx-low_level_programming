this is more functions and more nested loops
